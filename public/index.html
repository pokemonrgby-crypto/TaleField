<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TaleField :: Reborn</title>
  <link rel="stylesheet" href="./style.css">
  
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self' 'unsafe-inline' https://www.gstatic.com https://apis.google.com;
  connect-src 'self'
    https://firestore.googleapis.com
    https://identitytoolkit.googleapis.com
    https://securetoken.googleapis.com
    https://firebaseinstallations.googleapis.com
    https://www.googleapis.com
    https://www.gstatic.com
    https://us-central1-peaceful-doodad-471301-s2.cloudfunctions.net;
  frame-src 'self' https://accounts.google.com https://apis.google.com https://www.gstatic.com;
  img-src 'self' data: https:;
  style-src 'self' 'unsafe-inline';
">
</head>
<body>
  <main>
    <section id="view-lobby" class="active">
      <h1 class="page-title">로비</h1>
      <p class="muted">실시간으로 방 목록을 보여줍니다. 참여하거나 새 방을 만들어보세요.</p>
    </section>

    <section id="view-room">
      <h1 class="page-title">게임 룸</h1>
      <p class="muted">플레이어가 모이면 호스트가 게임을 시작할 수 있습니다. 실시간 배틀이 진행됩니다.</p>
    </section>
    
    <section id="view-my-cards">
        <h1 class="page-title">내 카드</h1>
        <div class="toolbar">
            <button id="btn-refresh-my-cards" class="btn">새로고침</button>
            <span id="my-cards-status" class="muted">내가 생성한 카드 목록입니다.</span>
        </div>
        <div id="my-cards-grid" class="card-grid">
            </div>
    </section>

    <section id="view-gen">
      <h1 class="page-title">AI 카드 생성</h1>
      <div class="toolbar">
        <textarea id="gen-prompt" placeholder="만들고 싶은 카드의 아이디어를 150자 내로 자유롭게 적어주세요." maxlength="150"></textarea>
        <label>생성 개수 <input id="gen-count" type="number" value="6" min="1" max="12" style="width:70px"></label>
        <label>최대 파워 <input id="gen-power" type="number" value="10" min="1" max="20" style="width:80px"></label>
        <label>창의성 <input id="gen-temp" type="number" step="0.1" min="0" max="1" value="0.8" style="width:80px"></label>
        <button id="btn-gen-cards" class="btn primary">Generate</button>
        <span id="gen-status" class="muted"></span>
      </div>
      <div id="gen-results" class="card-grid"></div>
    </section>
  </main>

  <nav class="bottom-nav">
    <div class="bottom-nav__tabs">
      <button data-tab="view-lobby" class="active">로비</button>
      <button data-tab="view-room">룸</button>
      <button data-tab="view-my-cards">내 카드</button> <button data-tab="view-gen">생성</button>
    </div>
    <div class="bottom-nav__user">
      <button id="btn-google" class="btn">Google 로그인</button>
      <button id="btn-logout" class="btn" style="display:none;">로그아웃</button>
    </div>
  </nav>

  <div id="nickname-modal" style="display:none;">
    <div class="card">
      <div class="card__body">
        <h3>닉네임 설정</h3>
        <p class="muted">게임에서 사용할 닉네임을 입력해주세요.</p>
        <input id="nickname-input" maxlength="12" placeholder="2~12자 닉네임" style="width:100%; margin: 10px 0;" />
        <div style="display:flex; gap:8px; margin-top:8px; align-items:center;">
          <button id="nickname-save" class="btn primary">저장</button>
          <span id="nickname-error" class="danger"></span>
        </div>
      </div>
    </div>
  </div>

  <script src="./js/firebase-config.js"></script>
  <script type="module" src="./js/app.js"></script>
</body>
</html>
